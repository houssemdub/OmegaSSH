<Window x:Class="OmegaSSH.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:fa="http://schemas.fontawesome.io/icons/"
        mc:Ignorable="d"
        Title="Settings" Height="500" Width="450"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BgBrush}"
        Foreground="{DynamicResource TextBrush}"
        WindowStyle="None"
        AllowsTransparency="True"
        x:Name="ThisWindow">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" GlassFrameThickness="0" CornerRadius="0" ResizeBorderThickness="8"/>
    </WindowChrome.WindowChrome>

    <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="4">
        <Grid Margin="15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                <fa:ImageAwesome Icon="Gear" Width="14" Foreground="{DynamicResource PrimaryAccentBrush}" Margin="0,0,10,0"/>
                <TextBlock Text="SETTINGS" FontSize="14" FontWeight="Bold"/>
            </StackPanel>

            <!-- Tabs/Sections -->
            <TabControl Grid.Row="1" Background="Transparent" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TabItem">
                                    <Border Name="Border" Padding="15,8" Margin="0,0,5,0" CornerRadius="5,5,0,0">
                                        <ContentPresenter ContentSource="Header" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="#1AFFFFFF"/>
                                            <Setter Property="Foreground" Value="{DynamicResource PrimaryAccentBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="#0DFFFFFF"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </TabControl.Resources>
                
                <TabItem Header="Appearance">
                    <ScrollViewer Margin="0,15,0,0">
                        <StackPanel>
                            <TextBlock Text="Terminal Font" Style="{StaticResource ModernLabel}"/>
                            <TextBox Text="{Binding TerminalFontFamily}" Style="{StaticResource ModernTextBox}" Margin="0,0,0,15"/>

                            <TextBlock Text="Font Size" Style="{StaticResource ModernLabel}"/>
                            <TextBox Text="{Binding TerminalFontSize}" Style="{StaticResource ModernTextBox}" Margin="0,0,0,15"/>
                            
                            <CheckBox IsChecked="{Binding EnableAnsiColors}" Content="Enable ANSI Colors" Foreground="{DynamicResource TextBrush}"/>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <TabItem Header="General">
                    <ScrollViewer Margin="0,20,0,0">
                        <StackPanel>
                            <CheckBox IsChecked="{Binding AutoConnect}" Content="Auto-connect to last session on startup" Foreground="{DynamicResource TextBrush}"/>

                            <TextBlock Text="SSH Keep Alive (seconds)" Style="{StaticResource ModernLabel}" Margin="0,15,0,0"/>
                            <TextBox Text="{Binding KeepAliveInterval}" Style="{StaticResource ModernTextBox}"/>

                            <TextBlock Text="Session Log Directory" Style="{StaticResource ModernLabel}" Margin="0,15,0,0"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Text="{Binding SessionLogPath}" Style="{StaticResource ModernTextBox}" IsReadOnly="True" Opacity="0.7"/>
                                <Button Grid.Column="1" Style="{StaticResource IconButton}" Command="{Binding BrowseLogPathCommand}" Margin="5,0,0,0">
                                    <fa:ImageAwesome Icon="FolderOpen" Width="14" Foreground="{DynamicResource TextDimBrush}"/>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>

            <!-- Actions -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                <Button Content="CANCEL" Command="{Binding CancelCommand}" CommandParameter="{Binding ElementName=ThisWindow}" 
                        Background="Transparent" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Padding="15,8" Margin="0,0,10,0"/>
                <Button Content="APPLY CHANGES" Command="{Binding SaveCommand}" CommandParameter="{Binding ElementName=ThisWindow}" 
                        Style="{StaticResource ModernButton}"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>
